{% extends "base.html" %}

{% block "content" %}

<div class="container">
  <div class="row">
    <div class="col-md-12">
      <h2>Current X-ray Image</h2>
      <div class="card">
        <img src="{{ xray.xray_img.url }}" class="card-img-top" style="max-width:100%; height:auto;">
        <div class="card-body">
          <p><strong>AI Result:</strong> {{ xray.prediction }}</p>
          <p><strong>Probability:</strong> {% if xray.probability == 0 %}0{% else %}{{ xray.probability|floatformat:"2" }}{% endif %}%</p>
          <p><strong>Owner:</strong> {{ xray.xray_owner }}</p>
        </div>
      </div>
    </div>
  </div>
  
  {% if xray.has_original %}
  <div class="row mt-4">
    <div class="col-md-6">
      <h3>Original Image</h3>
      <div class="card">
        <img src="{{ xray.xray_img_origin.url }}" class="card-img-top" style="max-width:100%; height:auto;">
        <div class="card-body">
          <p class="text-muted">This is the original uploaded image before any processing.</p>
          <form method="POST" action="{% url 'restore_original' %}">
            {% csrf_token %}
            <button type="submit" name="restore_btn" value="{{ xray.id }}" class="btn btn-warning">Restore as Main Image</button>
          </form>
        </div>
      </div>
    </div>
    
    {% if xray.has_detection_result %}
    <div class="col-md-6">
      <h3>Detection Result</h3>
      <div class="card">
        <img src="{{ xray.xray_img_det.url }}" class="card-img-top" style="max-width:100%; height:auto;">
        <div class="card-body">
          <p class="text-muted">This shows the object detection results with bounding boxes.</p>
        </div>
      </div>
    </div>
    {% endif %}
  </div>
  {% endif %}
  
  <div class="row mt-4">
    <div class="col-md-12">
      <a href="{% url 'display_xrays' %}" class="btn btn-secondary">Back to All Images</a>
    </div>
  </div>
</div>

{% endblock %}